{% extends "base.html" %}
{% block title %}Data Insights{% endblock %}

{% block extra_head %}
  <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-lite@5"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>
{% endblock %}

{% block content %}
  <h2 class="page-heading">Data Insights</h2>
  <section class="grid">
    {% for chart_name in specs.keys() %}
      <article class="card">
        <h3>{{ chart_name.replace("_", " ") | title }}</h3>
        <div id="chart-{{ chart_name }}"></div>
      </article>
    {% endfor %}
  </section>
{% endblock %}

{% block scripts %}
  <script>
    const specs = {{ specs | tojson }};
    Object.keys(specs).forEach(name => {
      vegaEmbed(`#chart-${name}`, specs[name], { actions: false });
    });
  </script>
{% endblock %}

